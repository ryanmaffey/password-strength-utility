/**
 * Password Strength Utility
 * -------------------------
 * Version:   1.1.0
 * Author:    Ryan Maffey
 * GitHub:    https://github.com/ryanmaffey/password-strength-utility
 * npm:       https://www.npmjs.com/package/password-strength-utility
 */
function PasswordStrength(e){function r(){var r="PasswordStrength: This is not a [data-pws] element.",t="string"==typeof e?function(){var t=document.querySelectorAll(e);if(t.length)return void console.warn("PasswordStrength: '"+e+"' was not found.");var n=[].slice.call(t).filter(function(e){return e.hasAttribute("[data-pws]")});return n.length?new _PWS(n[0]):void console.warn(r,e)}():function(){return e.hasAttribute("[data-pws]")?new _PWS(e):void console.warn(r,e)}();return t&&PWS._PWSArray.push(t),t}return null==e&&void 0==e?void PWS.warn("Did you mean to pass in a selector to PasswordStrength()?"):function(){var t;if("string"==typeof e)t=PasswordStrength._PWSArray.filter(function(r){return r.password.elem.matches(e)});else{if(!(e instanceof HTMLElement))return void PWS.warn("Selector must be of type String or HtmlElement. Instead found '"+typeof e+"'.",e);t=PasswordStrength._PWSArray.filter(function(r){return r.password.elem==e})}return t.length?t[0]:r()}()}function _PWS(e){var r=this;r.password={elem:e,value:e.value},r.rules=[],r.score=0,r.label=PWS.labels[0],r.isValid=!1,r.regex=null,r.init()}var PWS=PasswordStrength;PWS.availableRules=["length","upper","lower","number","special"],PWS.events={scoreChange:new CustomEvent("pwsScoreChange"),labelChange:new CustomEvent("pwsLabelChange"),ruleMatchChange:new CustomEvent("pwsRuleMatchChange"),validityChange:new CustomEvent("pwsValidityChange")},PWS._PWSArray=[],PWS.setup=function(e){function r(e,r){e="Invalid PasswordStrength.setup() parameter. "+e,r?PWS.warn(e,r):PWS.warn(e)}function t(){if(!e.labels)return PWS.labels={},!0;var t,n=["0","1","2","3","4"],s=[];for(var a in e.labels)if(s.push(a),"string"!=typeof e.labels[a]){t="The value '"+e.labels[a]+"' for the '"+a+"' property on the labels object is not a string.";break}return t?void r(t):(s=s.sort(),!(n.length!=s.length||!n.every(function(e,r){return e===s[r]}))||(r("Missing required properties on the labels object. Properties of 0, 1, 2, 3 and 4 are required, with values of type 'string'.",e.labels),!1))}function n(){var t,n=0;for(var s in e.rules)if(PWS.availableRules.indexOf(s)>-1){n++;var a=e.rules[s],l=parseInt(a);if(isNaN(l)||a!=l){t="The value '"+e.rules[s]+"' for the '"+s+"' property on the rules object is not an integer.";break}e.rules[s]=parseInt(e.rules[s])}return n?!t||(r(t),!1):(r("There are no valid rules on in the rules object.",e.rules),!1)}(function(){return e?"object"!=typeof e?(r("Parameter must be an object. Instead found '"+typeof e+"'.",e),!1):e.labels&&"object"!=typeof e.labels?(r("The labels property is not an object. Instead found '"+typeof e.labels+"'.",e.labels),!1):e.rules?"object"!=typeof e.rules?(r("The rules property must be an object. Instead found '"+typeof e.rules+"'.",e.rules),!1):t()&&n():(r("The rules property is required."),!1):(r("No parameter found."),!1)})()&&(e.labels&&(PWS.labels=e.labels),PWS.rules=e.rules,[].slice.call(document.querySelectorAll("[data-pws]")).forEach(function(e){PWS._PWSArray.push(new _PWS(e))}))},PWS.warn=function(e,r){e="PasswordStrength: "+e,r?console.warn(e,r):console.warn(e)},_PWS.prototype.addRules=function(){var e=this;return PWS.rules.length&&e.rules.push({name:"length",regex:"^.{"+PWS.rules.length+",}$"}),PWS.rules.number&&e.rules.push({name:"number",regex:"(.*[0-9]){"+PWS.rules.number+"}"}),PWS.rules.upper&&e.rules.push({name:"upper",regex:"(.*[A-Z]){"+PWS.rules.upper+"}"}),PWS.rules.lower&&e.rules.push({name:"lower",regex:"(.*[a-z]){"+PWS.rules.lower+"}"}),PWS.rules.special&&e.rules.push({name:"special",regex:"(.*[\\W]){"+PWS.rules.special+"}"}),e.rules.map(function(r){return r.isPassed=function(){return new RegExp(this.regex,"g").test(e.password.value)},r}),e},_PWS.prototype.update=function(){var e=this;return function(){var r=e.rules.filter(function(e){var r=e.isPassing;return e.isPassing=e.isPassed(),r!=e.isPassing});r.length&&(PWS.events.ruleMatchChange.data=r,e.password.elem.dispatchEvent(PWS.events.ruleMatchChange))}(),function(){var r;try{r=zxcvbn(e.password.value).score}catch(t){r=Math.floor(e.rules.filter(function(e){return e.isPassing}).length/e.rules.length*4)}r!=e.score&&(e.score=r,PWS.events.scoreChange.data=r,e.password.elem.dispatchEvent(PWS.events.scoreChange))}(),function(){var r=PWS.labels[e.score];r!=e.label&&(e.label=r,PWS.events.labelChange.data=r,e.password.elem.dispatchEvent(PWS.events.labelChange))}(),function(){var r=new RegExp(e.regex,"g").test(e.password.value);r!=e.isValid&&(e.isValid=r,PWS.events.validityChange.data=r,e.password.elem.dispatchEvent(PWS.events.validityChange))}(),e},_PWS.prototype.bindEvents=function(){var e=this;return e.password.elem.addEventListener("input",function(r){e.password.value=r.target.value,e.update()}),e},_PWS.prototype.generateRegex=function(){var e,r=this,t="";return r.rules.map(function(r){"length"!=r.name?t+="(?="+r.regex+")":e=r.regex}),e&&(t+=e.replace("^","").replace("$","")),r.regex=t,r},_PWS.prototype.init=function(){return this.addRules().generateRegex().bindEvents().update()};